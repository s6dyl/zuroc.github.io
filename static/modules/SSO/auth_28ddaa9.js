define("SSO/auth",function(o){var n;n=function(o,n,e,s){return $.modal(o,{dimmerClassName:"form "+n},e,s)},$.SSO.auth={"new":function(){var o;return o=n('<style>#SsoAuthLogin .login {\n  margin-top: 3em;\n  color: #9C847F; }\n\n  #SsoAuthLogin .login a {\n    color: #9C847F; }\n\n    #SsoAuthLogin {\n      height: 100%; }\n\n      #SsoAuthLogin .login a:hover {\n        color: #fff;\n        padding-bottom: 5px;\n        border-bottom: 2px solid #fff; }\n\n        #SsoAuthLogin .content {\n          max-width: 600px;\n          margin: auto; }</style><i class="close icon"></i><form ms-submit=submit id=SsoAuthLogin><div class=vc2><div class=vc1><div class=content><div class="description ui form"><div class=field><input spellcheck autocomplete=off ms-duplex=o.username name=username><label>昵称</label></div><div class=field><input spellcheck autocomplete=off ms-duplex=o.mobilePhoneNumber name=mobilePhoneNumber><label>手机</label></div><div class=field><input spellcheck autocomplete=off ms-duplex=o.email name=email><label>邮箱</label></div><div class=field><input autocomplete=off ms-duplex=o.password type=password ms-duplex=o.password name=password><label>密码</label></div><div class="one fluid ui inverted buttons"><button type=submit class="ui green ok basic inverted button">创建账号</button></div><div class=login>已经注册 ？<a href="javascript:$$(\'SSO/auth.login\');void(0)">点此登录</a></div></div></div></div></div><input type=submit class=hideSubmit></form>',"red","ssoAuthNew",function(o){var n,e;return n=$.error_tip(o),e={o:{email:"",mobilePhoneNumber:"",username:"",password:""},submit:function(){return AV.Cloud.run("SSO.auth.new",e.o,{success:function(){return AV.User.logIn(e.o.email,e.o.password,{success:function(){return $.modal_alert("<h1><p>账号创建成功。</p><p>开始一段新的旅程吧！</p></h1>",{onApprove:function(){return location.reload()}})}})},fail:function(o){return n.set(o)}}),!1}}})},login:function(){return o.async("lib/store",function(){var o;return o=n('<style>#SsoAuthLogin .login {\n  margin-top: 3em;\n  color: #9C847F; }\n\n  #SsoAuthLogin .login a {\n    color: #9C847F; }\n\n    #SsoAuthLogin {\n      height: 100%; }\n\n      #SsoAuthLogin .login a:hover {\n        color: #fff;\n        padding-bottom: 5px;\n        border-bottom: 2px solid #fff; }\n\n        #SsoAuthLogin .content {\n          max-width: 600px;\n          margin: auto; }</style><i class="close icon"></i><form ms-submit=submit id=SsoAuthLogin><div class=vc2><div class=vc1><div class=content><div class="description ui form"><div class=field><input spellcheck autocomplete=off ms-duplex=o.account name=account placeholder="请输入您的 昵称 或 手机 或 邮箱"><label>账号</label></div><div class=field><input autocomplete=off ms-duplex=o.password type=password ms-duplex=o.password name=password><label>密码</label></div><div class="one fluid ui inverted buttons"><button type=submit class="ui green ok basic inverted button">开始使用</button></div><div class=login>没有账号 ？<a href="javascript:$$(\'SSO/auth.new\');void(0)">点此注册</a></div></div></div></div></div><input type=submit class=hideSubmit></form>',"green","ssoAuthLogin",function(o){var n,e;return n=$.error_tip(o),avalon.nextTick(function(){return o.find("[name=account]").focus().select()}),e={o:{account:store.get("username")||"",password:""},submit:function(){var o,s,t;return o=e.o.account,t=isNaN(o-0)?AV.User.logIn:AV.User.logInWithMobilePhone,s={},o||(s.account=""),e.o.password||(s.password=""),n.set(s)||t(o,e.o.password,{success:function(o){return store.set("username",o.getUsername()),location.reload()},error:function(o,t){return 211===t.code?s.account="该账号不存在":210===t.code&&(s.password="密码错误。忘记密码了？<a href=\"javascript:$$('SSO.auth.reset_password', '"+e.o.account+"');void(0)\">点此找回。</a>"),n.set(s)}}),!1}}})})}}});